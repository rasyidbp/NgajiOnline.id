{% extends 'ngajionline/base.html' %}

{% block static %}
    {% load static %}
{% endblock static %}

{% block title %} 
NgajiOnline.id - Community 
{% endblock title %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/community-styles.css' %}">
{% endblock style %}

{% block main %}
<header class="hero">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-12 hero-content text-center">
                <h1 class="display-4 fw-bold mb-4 animate-on-scroll">NgajiOnline.id Community</h1>
                <p class="lead mb-5 animate-on-scroll">
                    Terhubung, belajar, dan berkembang bersama sesama penggemar Al-Quran
                </p>
            </div>
        </div>
    </div>
</header>

<main class="py-5">
    <div class="container">
        <div class="community-content">
            <ul class="nav nav-tabs community-tabs mb-4" id="communityTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="discussions-tab" data-bs-toggle="tab"
                        data-bs-target="#discussions" type="button" role="tab" aria-controls="discussions"
                        aria-selected="true">Diskusi</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="members-tab" data-bs-toggle="tab" data-bs-target="#members"
                        type="button" role="tab" aria-controls="members" aria-selected="false">Anggota</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="events-tab" data-bs-toggle="tab" data-bs-target="#events"
                        type="button" role="tab" aria-controls="events" aria-selected="false">Acara</button>
                </li>
            </ul>
            <div class="tab-content" id="communityTabsContent">
                <!-- Tab Diskusi -->
                <div class="tab-pane fade show active" id="discussions" role="tabpanel"
                    aria-labelledby="discussions-tab">
                    <h2 class="section-title mb-4">Diskusi Terbaru</h2>
                    <div class="discussion-list">
                        {% for discussion in discussions %}
                        <div class="discussion-item animate-on-scroll">
                            <h3 class="h5 mb-2">{{ discussion.title }}</h3>
                            <p class="text-muted mb-2">{{ discussion.content|truncatewords:20 }}</p>
                            <div class="d-flex align-items-center text-muted">
                                <span class="me-3"><i class="far fa-user me-1"></i> {{ discussion.author.username }}</span>
                                <span class="me-3"><i class="far fa-comment me-1"></i> {{ discussion.comment_set.count }} balasan</span>
                                <span><i class="far fa-clock me-1"></i> {{ discussion.created_at|timesince }} yang lalu</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Tab Anggota -->
                <div class="tab-pane fade" id="members" role="tabpanel" aria-labelledby="members-tab">
                    <h2 class="section-title mb-4">Anggota Komunitas</h2>
                    <div class="row">
                        {% for profile in members %}
                        <div class="col-md-6 col-lg-4 mb-4">
                            <div class="member-item d-flex align-items-center animate-on-scroll">
                                <img src="{% if profile.user.socialaccount_set.all.0.get_avatar_url %}{{ profile.user.socialaccount_set.all.0.get_avatar_url }}{% else %}https://i.pravatar.cc/150?img={{ forloop.counter }}{% endif %}" 
                                    alt="{{ profile.user.username }}" class="me-3">
                                <div>
                                    <h3 class="h5 mb-1">{{ profile.user.get_full_name|default:profile.user.username }}</h3>
                                    <p class="text-muted mb-0">Bergabung {{ profile.join_date|timesince }} yang lalu</p>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Tab Acara -->
                <div class="tab-pane fade" id="events" role="tabpanel" aria-labelledby="events-tab">
                    <h2 class="section-title mb-4">Acara Mendatang</h2>
                    <div class="event-list">
                        {% for event in events %}
                        <div class="event-item animate-on-scroll">
                            <h3 class="h5 mb-2">{{ event.title }}</h3>
                            <p class="text-muted mb-2">{{ event.description|truncatewords:30 }}</p>
                            <div class="d-flex align-items-center text-muted">
                                <span class="me-3"><i class="far fa-calendar me-1"></i> {{ event.date|date:"d F, Y" }}</span>
                                <span><i class="far fa-clock me-1"></i> {{ event.start_time|time:"H:i" }} - {{ event.end_time|time:"H:i" }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock main %}

{% block js %}
<script src="{% static 'js/community-script.js' %}"></script>
{% endblock js %}
